geometry :
  nemo variables:
    - name: ice_area_fraction
      nemo field name: iiceconc
      model space: surface
    - name: sea_surface_temperature
      nemo field name: votemper
      model space: surface
    - name: ice_area_fraction_background_error
      nemo field name: sic_tot_var
      model space: surface
      variable type: background variance
    - name: sea_surface_temperature_background_error
      nemo field name: t_tot_var
      model space: surface
      variable type: background variance
  grid name: ORCA2_T
  number levels: 1
state :
  date: 2021-06-30T00:00:00Z
  state variables: [ sea_surface_temperature, sea_surface_temperature_background_error ]
  nemo field file: Data/orca2_t_nemo.nc
  variance field file: Data/orca2_t_bkg_var.nc
window begin: 2021-06-29T12:00:00Z
window length: P1D
observations:
  observers:
  - obs space:
      name: Sea Surface Temperature
      obsdatain:
        obsfile: Data/hofx_sst_obs.nc
        max frame size: 1000000
      obsdataout:
        obsfile: testoutput/hofx3d_nc_sst_jopa.nc
        max frame size: 1000000
      simulated variables: [sea_surface_temperature]
    get values:
      atlas-interpolator:
        type: finite-element
        non_linear: missing-if-all-missing
    obs operator:
      name: Composite
      components:
      - name: Identity
      - name: BackgroundErrorIdentity
    obs filters:
    - filter: Variable Assignment
      assignments:
      - name: sea_surface_temperature@GrossErrorProbability
        type: float
        value: 0.04
    - filter: Bayesian Background Check
      filter variables:
      - name: sea_surface_temperature
      prob density bad obs: 1.0
      PGE threshold: 0.5
test:
  reference filename: testoutput/test_hofx3d_nc_sst.ref
